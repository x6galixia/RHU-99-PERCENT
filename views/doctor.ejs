<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css"/>
    <link rel="stylesheet" href="/css/doctor-func.css" />
    <script src="/js/websocket.js"></script>
    <title>Doctor</title>
  </head>
  <body>
    <!-- User Info -->
    <div>
      <%= surname %> <%= firstname %> <%= middle_initial %> <%= profession %>
    </div>

    <!-- Search Form -->
    <form action="/search-patient" method="post">
      <input type="text" name="search" placeholder="Search name or unique ID" />
      <button type="submit">Search</button>
    </form>

    <!-- Logout Form -->
    <form action="/logout?_method=DELETE" method="POST">
      <div>
        <button type="submit">Log out</button>
      </div>
    </form>
    <!-- Patients Table -->
    <table>
      <thead>
        <tr>
          <th>User ID</th>
          <th>Date</th>
          <th>Lastname</th>
          <th>Firstname</th>
          <th>Middle name</th>
          <th>Purok/Street</th>
          <th>Barangay</th>
          <th>Town/City</th>
          <th>Birthdate</th>
          <th>Gender</th>
          <th>Age</th>
          <th>Phone no</th>
          <th>Email</th>
          <th>Philhealth no</th>
          <th>Occupation</th>
          <th>Guardian</th>
          <th>Diagnoses</th>
          <th>Findings</th>
          <th>Medicine</th>
          <th>instruction</th>
          <th>quantity</th>
          <th>Vital Signs</th>
          <th>Laboratory request</th>
          <th>Laboratory result</th>
          <th>Diagnose</th>
          <th>Findings</th>
          <th>Prescribe</th>
        </tr>
      </thead>
      
      <tbody>
        <% if (patientListDrop && patientListDrop.length > 0) { %>
          <% patientListDrop.forEach(pt => { %>
            <tr>
              <td><%= pt.unq_id %></td>
              <td><%= pt.check_date %></td>
              <td><%= pt.last_name %></td>
              <td><%= pt.first_name %></td>
              <td><%= pt.middle_name %></td>
              <td><%= pt.address %></td>
              <td><%= pt.barangay %></td>
              <td><%= pt.town %></td>
              <td><%= pt.birthdate %></td>
              <td><%= pt.gender %></td>
              <td><%= pt.age %></td>
              <td><%= pt.phone %></td>
              <td><%= pt.email %></td>
              <td><%= pt.philhealth_no %></td>
              <td><%= pt.occupation %></td>
              <td><%= pt.guardian %></td>
              <td><%= pt.diagnoses %></td>
              <td><%= pt.findings %></td>
              <td><%= pt.medicine %></td>
              <td><%= pt.instruction %></td>
              <td><%= pt.quantity %></td>
              <td>
                <!-- Vitals Button -->
                <button class="openVitals"
                  data-unq-id="<%= pt.unq_id %>"
                  data-full-name="<%= pt.first_name %> <%= pt.last_name %>"
                  data-height="<%= pt.height %>"
                  data-weight="<%= pt.weight %>"
                  data-systolic="<%= pt.systolic %>"
                  data-diastolic="<%= pt.diastolic %>"
                  data-temperature="<%= pt.temperature %>"
                  data-pulse-rate="<%= pt.pulse_rate %>"
                  data-respiratory-rate="<%= pt.respiratory_rate %>"
                  data-bmi="<%= pt.bmi %>"
                  data-comment="<%= pt.comment %>">Vital Signs</button>
              </td>
              <td>
                <!-- Lab Request Button -->
                <button class="openLabReq"
                data-unq-id="<%= pt.unq_id %>"
                data-check-date="<%= pt.check_date %>"
                  data-full-name="<%= pt.first_name %> <%= pt.last_name %>"
                  data-date="<%= pt.date_now %>"
                  data-age="<%= pt.age %>"
                  data-gender="<%= pt.gender %>"
                  data-birthdate="<%= pt.birthdate %>"
                  data-occupation="<%= pt.occupation %>"
                  data-guardian="<%= pt.guardian %>">Laboratory Request</button>
              </td>
              <td>
                <!-----------lab result-->
                <button class="openLabRes"
                  data-unq-id="<%= pt.unq_id %>"
                  data-check-date="<%= pt.check_date %>"
                  data-full-name="<%= pt.first_name %> <%= pt.last_name %>"
                  data-date="<%= pt.date_now %>"
                  data-age="<%= pt.age %>"
                  data-gender="<%= pt.gender %>"
                  data-birthdate="<%= pt.birthdate %>"
                  data-occupation="<%= pt.occupation %>"
                  data-guardian="<%= pt.guardian %>"
                  data-lab-results='<%= JSON.stringify(pt.lab_result) %>'>Laboratory Result</button>
              </td>
              <td>
                <!-------diagnoses-->
                <button class="openDiagnose"
                data-unq-id="<%= pt.unq_id %>"
                data-check-date="<%= pt.check_date %>"
                data-full-name="<%= pt.first_name %> <%= pt.last_name %>"
                data-date="<%= pt.date_now %>"
                data-age="<%= pt.age %>"
                data-gender="<%= pt.gender %>"
                data-birthdate="<%= pt.birthdate %>"
                data-occupation="<%= pt.occupation %>"
                data-guardian="<%= pt.guardian %>">Diagnose</button>
              </td>
              <td>
                <!-------findings--->
                <button class="openFindings"
                data-unq-id="<%= pt.unq_id %>"
                data-check-date="<%= pt.check_date %>"
                data-full-name="<%= pt.first_name %> <%= pt.last_name %>"
                data-date="<%= pt.date_now %>"
                data-age="<%= pt.age %>"
                data-gender="<%= pt.gender %>"
                data-birthdate="<%= pt.birthdate %>"
                data-occupation="<%= pt.occupation %>"
                data-guardian="<%= pt.guardian %>">Findings</button>
              </td>
              <td>
                <!----------prescribe------>
                <button class="openPrescribe"
                data-unq-id="<%= pt.unq_id %>"
                data-check-date="<%= pt.check_date %>"
                data-full-name="<%= pt.first_name %> <%= pt.middle_name %> <%= pt.last_name %>"
                data-date="<%= pt.date_now %>"
                data-age="<%= pt.age %>"
                data-gender="<%= pt.gender %>"
                data-birthdate="<%= pt.birthdate %>"
                data-contact-number="<%= pt.phone %>"
                data-full-address="<%= pt.address %> <%= pt.barangay %> <%= pt.town %>"
                data-occupation="<%= pt.occupation %>"
                data-guardian="<%= pt.guardian %>"
                data-doctor="<%= profession %> <%= surname %> <%= firstname %> <%= middle_initial %>"
                >Prescribe</button>
              </td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr>
            <td colspan="26">No patients.</td>
          </tr>
          <% } %>
      </tbody>
    </table>
    
    <!-- Vital Signs Form -->
    <div id="vitalForm" style="display: none">
      <form>
        <div id="closeVitalsBtn">&times;</div>
        <div class="form">
          <h1>VITAL SIGNS</h1>
          <input type="text" id="unq_id" name="unq_id" placeholder="Unique ID" readonly />
          <input type="text" id="full_name" name="full_name" placeholder="Full name" readonly />
          <input type="text" id="height" name="height" placeholder="Height" readonly />
          <input type="text" id="weight" name="weight" placeholder="Weight" readonly />
          <input type="text" id="systolic" name="systolic" placeholder="Systolic" readonly />
          <input type="text" id="diastolic" name="diastolic" placeholder="Diastolic" readonly />
          <input type="text" id="temperature" name="temperature" placeholder="Temperature" readonly />
          <input type="text" id="pulse_rate" name="pulse_rate" placeholder="Pulse Rate" readonly />
          <input type="text" id="respiratory_rate" name="respiratory_rate" placeholder="Respiratory Rate" readonly />
          <input type="text" id="bmi" name="bmi" placeholder="BMI" readonly />
          <input type="text" id="comment" name="comment" placeholder="Comment" readonly />
        </div>
      </form>
    </div>

    <!-- Prescribe Form -->
    <div id="prescribeForm" style="display: none">
      <form action="/send-prescription" method="post">
        <div id="closePrescribeBtn">&times;</div>
        <h1>PRESCRIBE</h1>
        <input type="text" id="pres_unq_id" name="unq_id" placeholder="Unique ID" readonly />
        <input type="date" id="pres_check_date" name="check_date" readonly />
        <input type="text" id="pres_full_name" name="full_name" placeholder="Full Name" readonly />
        <input type="number" id="pres_age" name="age" placeholder="Age" readonly />
        <input type="text" id="pres_gender" name="gender" placeholder="Gender" readonly />
        <input type="date" id="pres_birthdate" name="birthdate" readonly />
        <input type="text" id="pres_phone" name="phone" readonly style="display: none;"> 
        <input type="text" id="pres_full_address" name="full_address" readonly />
        <input type="text" id="pres_occupation" name="occupation" readonly />
        <input type="text" id="pres_guardian" name="guardian" readonly />
 
        <input type="text" id="pres_reciever" name="reciever" placeholder="reciever">
        <input type="text" id="pres_relationship" name="relationship" placeholder="relationship">
        <input type="text" id="search-box" name="medicine" placeholder="Search...">
        <div id="suggestions" class="suggestions"></div>
        <input type="text" id="pres_instruction" name="instruction" placeholder="instruction">
        <label for="pres_quantity">quantity:</label>
        <input type="number" id="pres_quantity" name="quantity">
        <input type="text" id="pres_doctor" name="doctor_name" placeholder="Doctor" readonly>

        <button type="submit">submit</button>
      </form>
    </div>

 <!-- Laboratory Request Form -->
<div id="labRequestForm" style="display: none">
  <form action="/labrequest" method="POST">
    <div id="closeLabRequestBtn">&times;</div>
    <h1>LABORATORY REQUEST</h1>
    <input type="text" id="req_unq_id" name="unq_id" placeholder="Unique ID" readonly />
    <input type="date" id="req_check_date" name="check_date" readonly />
    <input type="text" id="req_full_name" name="full_name" placeholder="Full Name" readonly />
    <input type="number" id="req_age" name="age" placeholder="Age" readonly />
    <input type="text" id="req_gender" name="gender" placeholder="Gender" readonly />
    <input type="date" id="req_birthdate" name="birthdate" readonly />
    <input type="text" id="req_occupation" name="occupation" readonly />
    <input type="text" id="req_guardian" name="guardian" readonly />

    <!-- Dynamic Category Fields Container -->
    <div id="category-fields-container">
      <!-- Initial Category Fields -->
      <div class="category-fields">
        <select class="category-dropdown" name="category">
          <option value="default" disabled selected>Select a category</option>
          <option value="option1">Option 1</option>
          <option value="option2">Option 2</option>
          <option value="option3">Option 3</option>
          <option value="option4" disabled>Option 4 (Disabled)</option>
        </select>

        <select class="service-dropdown" name="service">
          <option value="default" disabled selected>Select a service</option>
          <option value="option1">Option 1</option>
          <option value="option2">Option 2</option>
          <option value="option3">Option 3</option>
          <option value="option4" disabled>Option 4 (Disabled)</option>
        </select>
      </div>
    </div>

    <!-- Add More Button -->
    <button type="button" id="addMoreButton" onclick="addCategoryFields()">Add more</button>

    <!-- Submit Button -->
    <button type="submit">Submit</button>
  </form>
</div>

      <!-- Laboratory Result Form -->
      <div id="labResultForm" style="display: none">
        <form>
          <div id="closeLabResultBtn">&times;</div>
          <h1>LABORATORY RESULT</h1>
          <input type="text" id="res_unq_id" name="unq_id" placeholder="Unique ID" readonly />
          <input type="date" id="res_check_date" name="check_date" readonly />
          <input type="text" id="res_full_name" name="full_name" placeholder="Full Name" readonly />
          <input type="number" id="res_age" name="age" placeholder="Age" readonly />
          <input type="text" id="res_gender" name="gender" placeholder="Gender" readonly />
          <input type="date" id="res_birthdate" name="birthdate" readonly />
          <input type="text" id="res_occupation" name="occupation" readonly />
          <input type="text" id="res_guardian" name="guardian" readonly />
          
          <!-- Container for displaying multiple images -->
          <ul id="labResultList"></ul>
        </form>
      </div>

    <!-- Diagnoses Form -->
    <div id="diagnoseForm" style="display: none">
      <form action="/add-diagnoses" method="POST">
        <div id="closeDiagnoseBtn">&times;</div>
        <h1>Diagnoses</h1>
        <input type="text" id="dia_unq_id" name="unq_id" placeholder="Unique ID" readonly />
        <input type="date" id="dia_check_date" name="check_date" readonly />
        <input type="text" id="dia_full_name" name="full_name" placeholder="Full Name" readonly />
        <input type="number" id="dia_age" name="age" placeholder="Age" readonly />
        <input type="text" id="dia_gender" name="gender" placeholder="Gender" readonly />
        <input type="date" id="dia_birthdate" name="birthdate" readonly />
        <input type="text" id="dia_occupation" name="occupation" readonly />
        <input type="text" id="dia_guardian" name="guardian" readonly />
    
        <label for="diagnoses">Diagnoses</label>
        <input type="text" name="diagnoses" required>
    
        <button type="submit">Submit</button>
      </form>
    </div>
    

    <!-- Findings Form -->
    <div id="findingsForm" style="display: none">
      <form action="/add-findings" method="post">
        <div id="closeFindingsBtn">&times;</div>
        <h1>Findings</h1>
        <input type="text" id="fin_unq_id" name="unq_id" placeholder="Unique ID" readonly />
        <input type="date" id="fin_check_date" name="check_date" readonly />
        <input type="text" id="fin_full_name" name="full_name" placeholder="Full Name" readonly />
        <input type="number" id="fin_age" name="age" placeholder="Age" readonly />
        <input type="text" id="fin_gender" name="gender" placeholder="Gender" readonly />
        <input type="date" id="fin_birthdate" name="birthdate" readonly />
        <input type="text" id="fin_occupation" name="occupation" readonly />
        <input type="text" id="fin_guardian" name="guardian" readonly />

        <label for="findings">Findings</label>
        <input type="text" name="findings">

        <button type="submit">Submit</button>
      </form>
    </div>
    <script src="/js/doctor-func.js"></script>
  </body>
</html>
